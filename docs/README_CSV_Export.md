# TFT卡牌统计系统 - 功能说明

## 概述

本系统已更新多个功能，包括新的CSV导出格式和窗口截图功能，提供更便捷的数据分享和记录方式。

## 新功能特点

### 1. CSV导出功能
- **结构化数据组织**: 显示当前会话的基本信息、匹配记录和模板统计
- **清晰的字段定义**: 使用中文列标题，便于理解
- **完整的数据覆盖**: 包含当前会话的所有相关数据
- **自动保存**: 停止监控时自动保存到log文件夹
- **数据完整性**: 确保capture_sequence值正确记录，与main函数逻辑一致

### 2. 窗口截图功能
- **一键截图**: 点击"分享数据"按钮即可截取当前程序窗口
- **图片剪贴板**: 截图直接复制到系统剪贴板
- **多种格式支持**: 支持BMP和HTML格式剪贴板数据
- **便捷分享**: 可在其他应用程序中直接粘贴使用

## 功能使用方法

### CSV导出
1. **启动监控**: 点击"开始监控"按钮
2. **执行匹配**: 使用手动触发或按D键进行匹配
3. **导出数据**: 点击"保存记录"按钮
4. **选择位置**: 选择CSV文件保存位置
5. **查看结果**: 在日志区域查看导出状态

### 自动保存功能
- **自动触发**: 每次停止监控时自动保存记录
- **固定位置**: 自动保存到log文件夹
- **时间命名**: 使用系统时间作为文件名（yyyy-mm-dd-hh-mm-ss.csv）
- **无需手动**: 完全自动化，无需用户干预

### 窗口截图
1. **启动程序**: 运行TFT卡牌统计系统
2. **调整窗口**: 根据需要调整窗口大小和位置
3. **点击截图**: 点击"分享数据"按钮
4. **自动保存**: 截图自动保存为PNG文件
5. **路径复制**: 文件路径自动复制到剪贴板
6. **使用文件**: 直接使用保存的图片文件

## 技术实现

### CSV导出
- 使用标准CSV格式，兼容Excel等工具
- UTF-8编码，支持中文字符
- 使用空行分隔不同数据表
- 提供详细的错误处理和日志记录

### 窗口截图
- 使用PIL库的ImageGrab模块
- 自动获取窗口位置和大小
- 保存为PNG格式文件
- 支持文件路径剪贴板复制
- 提供友好的错误提示

## 依赖要求

### 必需依赖
- `tkinter`: Python GUI库（通常随Python安装）
- `sqlite3`: 数据库支持（通常随Python安装）
- `matplotlib`: 图表显示
- `numpy`: 数值计算支持

### 可选依赖
- `PIL` (Pillow): 截图功能支持
- `pyperclip`: 剪贴板复制功能
- `pynput`: 键盘监听功能

## 安装说明

```bash
# 安装基本依赖
pip install matplotlib numpy

# 安装截图功能依赖
pip install Pillow

# 安装剪贴板复制功能
pip install pyperclip

# 安装键盘监听功能
pip install pynput
```

## 故障排除

### CSV导出问题
- 确保有活动会话
- 检查数据库连接状态
- 查看日志区域的错误信息

### 截图功能问题
- 确保已安装Pillow库
- 检查窗口是否正常显示
- 验证文件写入权限
- 如需剪贴板功能，安装pyperclip库

## 更新日志

- **v2.0**: 添加新的CSV导出格式
- **v2.1**: 集成窗口截图功能
- **v2.2**: 优化错误处理和用户反馈
- **v2.3**: 添加停止监控时自动保存记录功能
- **v2.4**: 修复GUI中capture_sequence值缺失问题，与main函数逻辑保持一致

## 注意事项

1. 截图功能需要PIL库支持
2. 截图文件保存在程序运行目录
3. 如需剪贴板功能，需要安装pyperclip库
4. 窗口截图包含整个程序界面
5. CSV导出仅包含当前会话数据

## 技术支持

如遇到问题，请检查：
1. 依赖库是否正确安装
2. 日志区域的错误信息
3. 系统权限设置
4. Python版本兼容性
